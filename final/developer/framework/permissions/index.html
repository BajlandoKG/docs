<div class="docs-header">
    
    <div class="docs-header-logo">
        <a href="/">
            <img class="logo" src="/img/logo.svg" alt="Vanilla Forums" width="102" height="41" /> Docs
        </a>
    </div>
    
    <div class="docs-header-cta">
        <a href="http://pages.vanillaforums.com/free-trial-of-vanilla-forums" class="Button Primary Small">Free trial</a>
    </div>
    
    <div class="docs-header-search">
    Search
</div>
    
</div>


<div class="docs-title">
    <h1 class="docs-page-title">Permissions</h1>
    <div class="docs-page docs-improve">
        <i class="fa fa-pencil">Improve this document</i>
    </div>
</div>


<h2 id="permissions-overview">Permissions Overview</h2>

<p>Vanilla uses permissions to restrict access to particular content, options, or workflows. There are a number of functions built into the framework to do this efficiently. We eschew role-detection as a means of access control.</p>

<p>For example, we would never check to make sure someone was in a role named Moderator before granting access to an option, we would check a permission like <code>Garden.Moderation.Manage</code>.</p>

<h3 id="naming-permissions">Naming Permissions</h3>

<p>We use the same dot notation syntax for permissions as we do for config settings. A typical scheme would be: <code>Namespace.Keyword.Action</code>.</p>

<p>For instance, look at <code>Vanilla.Discussions.Add</code>. This permissions is registered by the Vanilla application, is related to discussions, and is specifically for adding.</p>

<p>For the Namespace (first dot tier), use the slug name of your addon. The <code>Plugins</code> namespace is deprecated.</p>

<p>The Keyword (second dot tier) should be the most concise description possible of the part of the addon it governs.</p>

<p>Whenever possible, use one of the following as your Action (third dot tier):</p>

<ul>
<li>Add</li>
<li>Edit</li>
<li>View</li>
<li>Manage</li>
<li>Delete</li>
</ul>

<p>Other action names are avoided and may be renamed or refactored out of the framework in the future. However, they are not forbidden and never will be.</p>

<h3 id="using-permissions">Using Permissions</h3>

<p>There are two basic ways to check a permission. One is to use a true/false conditional, typically to <code>CheckPermission()</code> in an <code>if</code> statement:</p>

<pre><code>if (CheckPermission('Permission.Name')) {
    // Do something special
}
</code></pre>

<p>The other is to wholesale block execution by a call to <code>Gdn::Session-&gt;Permission()</code>. This method automatically triggers a permission exception:</p>

<pre><code>public function Index() {
    Gdn::Session()-&gt;Permission('Permission.Name');
    // Do priviliged things safely now
}
</code></pre>

<p>Typically we don&rsquo;t use the first convention to trigger a permission exception manually because the second will cover it.</p>

<h3 id="multiple-permissions">Multiple Permissions</h3>

<p>You can use either method above to check multiple permissions by passing an array of permission names as the first parameter.</p>

<p>By default, it will require ALL permissions named to pass. If you pass a second parameter of <code>false</code>, then only ONE of the permissions is needed to pass.</p>

<p>You may find additional permission checks in Vanilla for permission names that do not appear in the Dashboard using this style: a normal permission name is passed in an array along with an &ldquo;invisible&rdquo; one. This is to allow plugins to define the additional permissions for more granular checks if needed.</p>

<h3 id="the-owner-flag">The Owner Flag</h3>

<p>The forum owner&rsquo;s account (the one you create when installing Vanilla) gets a special flag set on it. This is accomplished by setting the <code>Admin</code> column equal to <code>1</code> in the <code>User</code> table.</p>

<p>Accounts with this flag set bypass all permission checks. <code>CheckPermission</code> will always return <code>true</code> and no permission exception will ever be thrown for it. It will do this regardless of any role assignment.</p>

<p>For this reason, it is extremely important to test your addons with a non-owner account to see your permission checks in action.</p>

<h3 id="the-system-flag">The System Flag</h3>

<p>The System account is generated for general use by addons and cases where content must be generated by the forum. This account is designated by setting the <code>Admin</code> column equal to <code>2</code> in the <code>User</code> table.</p>

<p>This grants the same privileges as the Owner flag, and protects the account from deletion or banning.</p>

<h3 id="reversed-permission">Reversed Permission</h3>

<p>A special case in the framework is the <code>Vanilla.Approval.Require</code> permission. It is checked with the <code>CheckRequirement</code> function. A <code>true</code> result means their content must go to the Moderation queue for approval. Therefore, a <code>true</code> result actually grants you <em>less</em> permission. We don&rsquo;t generally recommend using this construct.</p>



<div class="docs-footer">
    <div class="docs-copyright">
        Copyright &copy 2009-2016 Vanilla Forums, Inc. All rights reserved.
    </div>
    <div class="docs-submenu">
        <ul>
            <li class="docs-submenu-item item-docs"><a href="http://docs.vanillaforums.com">Documentation</a></li>
            <li class="docs-submenu-item item-blog"><a href="https://blog.vanillaforums.com">Blog</a></li>
            <li class="docs-submenu-item item-cloud"><a href="https://vanillaforums.com">Cloud</a></li>
            <li class="docs-submenu-item item-community"><a href="https://vanillaforums.org/discussions">Community</a></li>
            <li class="docs-submenu-item item-github"><a href="https://github.com/vanilla/vanilla">GitHub</a></li>
            <li class="docs-submenu-item item-issues"><a href="https://github.com/vanilla/vanilla/issues">Issues</a></li>
        </ul>
    </div>
</div>